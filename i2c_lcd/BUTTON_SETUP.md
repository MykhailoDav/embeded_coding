# Weather Station з Кнопкою Керування

## 📌 Підключення кнопки

Кнопка підключається до піна **PD2 (D2)** на Arduino/ATmega328P.

### Схема підключення:

```
Кнопка:
┌─────────────┐
│   BUTTON    │
└──┬─────────┬┘
   │         │
   │         └──────── GND
   │
   └────────────────── PD2 (D2)

Внутрішній pull-up резистор увімкнений програмно!
```

### Деталі підключення:

| Компонент | Пін Arduino | Пін ATmega328P |
|-----------|-------------|----------------|
| Кнопка (один контакт) | D2 | PD2 |
| Кнопка (другий контакт) | GND | GND |

**Важливо:** Не потрібен зовнішній резистор - використовується внутрішній pull-up!

---

## 🎮 Функції кнопки

### 1️⃣ Одинарне натискання
- Перемикає режим відображення вручну
- Вимикає автоматичний режим
- Показує назву режиму протягом 1 секунди

**Режими:**
- 🌡️ **TEMPERATURE** - температура, тиск, висота
- 🕐 **TIME** - час та дата

### 2️⃣ Подвійне натискання (протягом 400 мс)
- Вмикає автоматичний режим
- Режими перемикаються кожні 2 секунди
- Показує "AUTOMATIC MODE" протягом 1 секунди

---

## ⏱️ Оновлення дисплея

- **Температура:** оновлюється кожні **500 мс**
- **Час:** оновлюється **постійно** (кожну мілісекунду через Timer0)
- **Timer0:** налаштований на переривання кожну **1 мс** для точного відліку часу

---

## 📟 Приклад використання

```c
// Налаштування таймера для millis()
TCCR0A = (1 << WGM01);  // CTC режим
TCCR0B = (1 << CS01) | (1 << CS00);  // Prescaler 64
OCR0A = 249;  // 250 тактів = 1 мс
TIMSK0 = (1 << OCIE0A);  // Переривання

// Ініціалізація кнопки
DDRD &= ~(1 << BUTTON_PIN);  // Вхід
PORTD |= (1 << BUTTON_PIN);  // Pull-up
Buttons_Init(&button, 1);

// Обробка кнопки в loop
Buttons_Update(millis());

if (button_state.double_click) {
    // Автоматичний режим
}
if (button_state.released) {
    // Перемкнути режим
}
```

---

## 🔧 Налаштування бібліотеки Buttons

### Додані можливості:
- ✅ Детекція подвійного кліку
- ✅ Таймаут для подвійного кліку: **400 мс**
- ✅ Лічильник кліків
- ✅ Час останнього відпускання кнопки

### Нові поля в `ButtonState`:
```c
bool double_click;              // Подвійний клік детектовано
uint32_t last_release_time;     // Час останнього відпускання
uint8_t click_count;            // Лічильник кліків
```

---

## 🖥️ Відображення на LCD

### Режим TEMPERATURE:
```
🌡23.4C H:250m
P:101325 Pa
```

### Режим TIME:
```
04.12.2025 Wed
    15:30:45
```

### При перемиканні (1 сек):
```
  TEMPERATURE
     MODE
```
або
```
   AUTOMATIC
     MODE
```

---

## 🚀 Запуск

1. Підключіть кнопку до PD2 (D2) та GND
2. Завантажте код
3. Натисніть кнопку два рази - увімкнеться автоматичний режим
4. Натисніть один раз - перемкніть режим вручну

**Готово!** ✨
